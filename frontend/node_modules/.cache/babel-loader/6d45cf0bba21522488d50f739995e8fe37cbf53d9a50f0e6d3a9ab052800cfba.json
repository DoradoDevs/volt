{"ast":null,"code":"import React,{useMemo,useState}from'react';import{useNavigate,useLocation}from'react-router-dom';import api from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Verify=_ref=>{let{setUser,email:emailProp}=_ref;const[code,setCode]=useState('');const[error,setError]=useState('');const navigate=useNavigate();const location=useLocation();const email=useMemo(()=>{var _location$state;return(emailProp||((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.email)||localStorage.getItem('pendingEmail')||'').trim().toLowerCase();},[emailProp,location.state]);const handleVerify=async e=>{e.preventDefault();try{const response=await api.post('/verify',{email,code:code.trim()});localStorage.setItem('token',response.data.token);localStorage.removeItem('pendingEmail');setUser(response.data.user);setError('');navigate('/dashboard');}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||'Verification failed');}};const handleResend=async()=>{try{await api.post('/login',{email});// reuse login to resend a fresh code\nsetError('');alert('A new verification code has been sent.');}catch(err){var _err$response2,_err$response2$data;setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.error)||'Could not resend code');}};return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',minHeight:'100vh',backgroundColor:'#4B0082',color:'#9370DB'},children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px',borderRadius:'8px',backgroundColor:'rgba(147, 112, 219, 0.1)'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Enter Verification Code\"}),/*#__PURE__*/_jsx(\"p\",{style:{opacity:0.8,marginTop:-8},children:email||'No email detected'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleVerify,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Verification Code: \"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:code,onChange:e=>setCode(e.target.value),style:{margin:'5px',padding:'5px'}})]}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Verify & Continue\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",style:{marginLeft:8},onClick:handleResend,children:\"Resend Code\"})]}),/*#__PURE__*/_jsx(\"p\",{children:\"Didn\\u2019t get it? Check spam or click \\u201CResend Code\\u201D.\"})]})});};export default Verify;","map":{"version":3,"names":["React","useMemo","useState","useNavigate","useLocation","api","jsx","_jsx","jsxs","_jsxs","Verify","_ref","setUser","email","emailProp","code","setCode","error","setError","navigate","location","_location$state","state","localStorage","getItem","trim","toLowerCase","handleVerify","e","preventDefault","response","post","setItem","data","token","removeItem","user","err","_err$response","_err$response$data","handleResend","alert","_err$response2","_err$response2$data","style","display","justifyContent","alignItems","minHeight","backgroundColor","color","children","padding","borderRadius","opacity","marginTop","onSubmit","type","value","onChange","target","margin","marginLeft","onClick"],"sources":["C:/Users/Clock/OneDrive/Desktop/volt/volt/frontend/src/components/Verify.js"],"sourcesContent":["import React, { useMemo, useState } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport api from '../services/api';\r\n\r\nconst Verify = ({ setUser, email: emailProp }) => {\r\n  const [code, setCode] = useState('');\r\n  const [error, setError] = useState('');\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  const email = useMemo(() =>\r\n    (emailProp || location.state?.email || localStorage.getItem('pendingEmail') || '').trim().toLowerCase(),\r\n  [emailProp, location.state]);\r\n\r\n  const handleVerify = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const response = await api.post('/verify', { email, code: code.trim() });\r\n      localStorage.setItem('token', response.data.token);\r\n      localStorage.removeItem('pendingEmail');\r\n      setUser(response.data.user);\r\n      setError('');\r\n      navigate('/dashboard');\r\n    } catch (err) {\r\n      setError(err.response?.data?.error || 'Verification failed');\r\n    }\r\n  };\r\n\r\n  const handleResend = async () => {\r\n    try {\r\n      await api.post('/login', { email }); // reuse login to resend a fresh code\r\n      setError('');\r\n      alert('A new verification code has been sent.');\r\n    } catch (err) {\r\n      setError(err.response?.data?.error || 'Could not resend code');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ display:'flex', justifyContent:'center', alignItems:'center', minHeight:'100vh', backgroundColor:'#4B0082', color:'#9370DB' }}>\r\n      <div style={{ padding:'20px', borderRadius:'8px', backgroundColor:'rgba(147, 112, 219, 0.1)' }}>\r\n        <h2>Enter Verification Code</h2>\r\n        <p style={{ opacity:0.8, marginTop:-8 }}>{email || 'No email detected'}</p>\r\n        <form onSubmit={handleVerify}>\r\n          <div>\r\n            <label>Verification Code: </label>\r\n            <input type=\"text\" value={code} onChange={(e) => setCode(e.target.value)} style={{ margin:'5px', padding:'5px' }} />\r\n          </div>\r\n          {error && <p style={{ color:'red' }}>{error}</p>}\r\n          <button type=\"submit\">Verify & Continue</button>\r\n          <button type=\"button\" style={{ marginLeft:8 }} onClick={handleResend}>Resend Code</button>\r\n        </form>\r\n        <p>Didn’t get it? Check spam or click “Resend Code”.</p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Verify;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}